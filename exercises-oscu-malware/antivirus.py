import sys
import base64
from Crypto.Cipher import AES


def check(filename):
    # Your solution.
    file = open(filename, 'r')
    lines = file.readlines()


    #checks unencrypted
    virustxt1 = 'variable_used_' + 'dkajhdskahsdkajdh'
    virustxt2 = 'this_is_a_new_var_' + 'addsadahdashgdsag'

    for line in lines:
        if virustxt1 in line:
            return 1

        elif virustxt2 in line:
            return 2


    #checks if encrypted
    enctxt = 'key = base64.b64decode'
    if enctxt in lines[3]:                          #if encrypted
        key = base64.b64decode(lines[3][23:-1])     #decode base64 characters that make up the key
        c1 = base64.b64decode(lines[4][22:-1])      #decode base64 characters that make up the payload 
        cipher = AES.new(key)                       #make a key from the decoded base64
        c2 = cipher.decrypt(c1).decode()            #decrypt payload with the key that we got

        if virustxt1 in c2:
            return 1

        if virustxt2 in c2:
            return 2

    #if no virus detected
    return None
    

if __name__ == '__main__':
    check(sys.argv[1])
